{% liquid
  assign id = section.id
%}
<link rel="stylesheet" href="{{ 'component-search.css' | asset_url }}" media="print" onload="this.media='all'">
{%- if settings.predictive_search_enabled -%}
  <link rel="stylesheet" href="{{ 'component-price.css' | asset_url }}" media="print" onload="this.media='all'">
{%- endif -%}

<style>
    #shopify-section-{{id}}{
      z-index: 5 !important;
    }
   .sec-{{ id }} {
    box-sizing: border-box;
    margin-top: {{section.settings.margin_top | append: 'px'}};
    margin-bottom: {{section.settings.margin_bottom | append: 'px'}};
    padding-top: {{section.settings.padding_top | append: 'px'}};
    padding-bottom: {{section.settings.padding_bottom | append: 'px'}};
  }

  @media(max-width: 1249px) {
     .sec-{{ id }} {
      margin-top: {{section.settings.margin_top_m | append: 'px'}};
      margin-bottom: {{section.settings.margin_bottom_m | append: 'px'}};
      padding-top: {{section.settings.padding_top_m | append: 'px'}};
      padding-bottom: {{section.settings.padding_bottom_m | append: 'px'}};
    }
  }

  .sec-{{ id }} .page-width{
    max-width: 2000px;
  }
  .regular__logo, .sticky__logo{
    width: {{ section.settings.logo_width }}px;
    height: auto;
  }
  @media screen and (max-width: 1249px){
    .sec-{{ id }} .page-width{
      padding: 0;
    }
    .regular__logo, .sticky__logo{
      width: {{ section.settings.logo_width_m }}px;
      height: auto;
    }
  }
  @media screen and (max-width: 989px){
    {% if template.name == 'product' %}
      .site__main-logo-fixed{
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        top: 33px !important;
        background-color: #000;
        padding: 8px 0;
      }
    {% endif %}
  }

  @media screen and (max-width: 1249px){
    {% if template.name == 'product' %}
    #shopify-section-{{id}} .site__header{
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s;
    }
    .drawer-open  #shopify-section-{{id}} .site__header{
        opacity: 1;
        visibility: visible;
    }
    {% endif %}

    {% if template.name == 'collection' %}
      .site__main-logo-fixed{
        display: none;
      }
    {% endif %}
  }
</style>


{% comment %} temporary fix................................... {% endcomment %}
<style>
  {% if template.name == 'collection' or template.name == 'product' %}
    .fixed__header .site__main-logo img{
      filter: invert(1);      
    }
  .fixed__header:hover .site__main-logo img{
      filter: invert(0);      
    }
  {% endif %}}
</style>  

{% comment %} temporary fix................................... {% endcomment %}


{% assign allowed_templates = section.settings.template_names %}
{% assign allowed_templates_array = section.settings.template_names | split: ',' %}
{% assign enable_transparent = section.settings.enable_transparent %}
{% assign enable_sticky = section.settings.enable_sticky %}

{% liquid
  assign allowed_invert = section.settings.invert_logo
  assign current_suffix = request.path | split: '/' | last
  assign current_template = template.name
%}

{% liquid
  assign logo_lg = section.settings.image
  assign logo_lg_width = section.settings.logo_width
  assign logo_sm = section.settings.image_m
  assign logo_sm_width = section.settings.logo_width_m
  if logo_sm == blank
    assign logo_sm = logo_lg
  elsif logo_lg == blank
    assign logo_lg = logo_sm
  endif
%}

{% liquid
  assign sticky_logo_lg = section.settings.sticky_logo
  assign sticky_logo_lg_width = section.settings.logo_width
  assign sticky_logo_sm = section.settings.sticky_logo_m
  assign sticky_logo_sm_width = section.settings.logo_width_m
  if sticky_logo_sm == blank
    assign sticky_logo_sm = sticky_logo_lg
  elsif sticky_logo_lg == blank
    assign sticky_logo_lg = sticky_logo_sm
  endif
%}

<div
  data-template="{{ template.name }}"
  data-suffix="{{ request.path | split: '/' | last }}"
  data-allowed="{{ allowed_templates }}"
  data-transparent="{{ enable_transparent }}"
  data-sticky="{{ enable_sticky }}"
  class="sec-{{ id }} site__header {% if template.name == 'product' %}site__header-product{% endif %}"
>
  <div class="{% unless section.settings.full_width %}page-width{% endunless %}">
    <div class="wrapper-{{ id }} site__header-wrapper hide__sm">
      {% comment %}
        <div class="header__drawer-container hide__lg">
          <a header-drawer-opener href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M3 12H15M3 6H21M3 18H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </a>
          {% render 'new-header-drawer',
            section: section,
            id: id,
            logo_lg: logo_lg,
            logo_lg_width: logo_lg_width,
            logo_sm: logo_sm,
            logo_sm_width: logo_sm_width
          %}
        </div>
      {% endcomment %}
      <a class="site__main-logo" site-logo href="/">
        {% unless logo_sm and logo_lg %}
          <h2>{{ shop.name }}</h2>
        {% else %}
          <picture>
            <source media="(min-width: 744px)" srcset="{{ logo_lg | image_url: width: logo_lg_width }}">
            {{ logo_sm | image_url: width: logo_sm_width | image_tag: class: 'regular__logo', loading: 'lazy' }}
          </picture>
        {% endunless %}
      </a>
      {% if allowed_templates_array contains template.name
        or allowed_templates_array contains current_suffix
        and section.settings.enable_transparent
        and sticky_logo_sm
        or sticky_logo_lg
      %}
        <a class="site__main-logo-sticky" site-logo href="/">
          {% unless sticky_logo_sm and sticky_logo_lg %}
            <h2>{{ shop.name }}</h2>
          {% else %}
            <picture>
              <source media="(min-width: 744px)" srcset="{{ sticky_logo_lg | image_url: width: sticky_logo_lg_width }}">
              {{
                sticky_logo_sm
                | image_url: width: sticky_logo_sm_width
                | image_tag: class: 'sticky__logo', loading: 'lazy'
              }}
            </picture>
          {% endunless %}
        </a>
      {% endif %}
      <nav class="site__nav hide__sm">
        {% render 'desktop-menu', section: section, id: id %}
      </nav>
      <div class="site__nav-icons">
        {% comment %}
        <div class="header__currency hide__sm">
          {% render 'currency-switcher' %}
        </div>
        {% endcomment %}
        <div class="header__search hide__sm-">
          {% comment %}
            {% render 'header-search', input_id: 'Search-In-Modal' %}
          {% endcomment %}
          <a
            href="#"
            class="header-icon glass__bg"
            header-search
          >
            {%- render 'header-icons', name: 'search' -%}
          </a>
        </div>
        <div class="header__account hide__sm">
          <a account-drawer href="/account">{% render 'header-icons', name: 'account' %}</a>
        </div>
        <div class="header__cart">
          <a
            id="cart-icon-bubble"
            class="new-header-cart-icon cart__counter-lg"
            aria-label="header cart icon"
            cart-drawer
            href="{{ routes.cart_url }}"
          >
            {%- render 'header-icons', name: 'bag' -%}
            {% if cart != empty %}
              <span class="cart__counter">{{ cart.item_count }}</span>
            {% endif %}
            {% comment %}
            {% if cart == empty %}
              {%- render 'header-icons', name: 'bag' -%}
              <span class="cart__counter hidden">{{ cart.item_count }}</span>
            {% else %}
              {%- render 'header-icons', name: 'bag' -%}
              <span class="cart__counter ">{{ cart.item_count }}</span>              
            {% endif %}
            {% endcomment %}
          </a>
        </div>
      </div>
    </div>
    <div class="wrapper-{{ id }} site__header-wrapper hide__lg">
      <div class="header__search">
        <a
          href="#"
          class="header-icon glass__bg"
          header-search
        >
          {%- render 'header-icons', name: 'search' -%}
        </a>
      </div>
      <div class="header__account">
        <a account-drawer href="/account">{% render 'header-icons', name: 'account' %}</a>
      </div>
      <div class="header__cart">
        <a
          id="cart-icon-bubble"
          class="new-header-cart-icon cart__counter-sm"
          aria-label="header cart icon"
          cart-drawer
          href="{{ routes.cart_url }}"
        >
            {%- render 'header-icons', name: 'bag' -%}
            {% if cart != empty %}
              <span class="cart__counter">{{ cart.item_count }}</span>
            {% endif %}
        </a>
      </div>
      <div class="header__drawer-container">
        <a class="glass__bg- header-icon lg-hide mobile-drawer-open pos-rel" mobile-drawer-opener href="#">
          <div class="burger__icon">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </a>
      </div>
    </div>
    
  </div>
</div>
{% render 'new-search', section: section, logo_sm: logo_sm, logo_lg: logo_lg, sticky_logo_lg: sticky_logo_lg, sticky_logo_sm: sticky_logo_sm, sticky_logo_lg_width: sticky_logo_lg_width, sticky_logo_sm_width: sticky_logo_sm_width %}
<a
  class="{% if allowed_invert contains current_template
  or allowed_invert contains current_suffix %}
    inverted_mbl-logo
  {% endif %} site__main-logo site__main-logo-fixed hide__lg"
  site-logo href="/">
  {% unless logo_sm and logo_lg %}
    <h2>{{ shop.name }}</h2>
  {% else %}
    <picture>
      <source media="(min-width: 744px)" srcset="{{ sticky_logo_lg | image_url: width: sticky_logo_lg_width }}">
      {{ sticky_logo_sm | image_url: width: sticky_logo_sm_width | image_tag: class: 'regular__logo', loading: 'lazy' }}
    </picture>
  {% endunless %}
</a>

{% render 'new-header-drawer',
  section: section,
  id: id,
  logo_lg: logo_lg,
  logo_lg_width: logo_lg_width,
  logo_sm: logo_sm,
  logo_sm_width: logo_sm_width,
  sticky_logo_lg: sticky_logo_lg,
  sticky_logo_lg_width: sticky_logo_lg_width,
  sticky_logo_sm: sticky_logo_sm,
  sticky_logo_sm_width: sticky_logo_sm_width
%}

<script src="{{ 'header-js.js' | asset_url }}" defer="defer"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<script>
    $( document ).ready(function() {
      $("span.expand-icon-container").click(function(e) {
        e.preventDefault();
        var toClose = $("#mobile-navigation ul").not($(this).parents("ul"));
        toClose.slideUp();
        toClose.parent().removeClass("open");
        if(!$(this).parent().next().is(":visible")) {
          var toOpen = $(this).parent().next()
          toOpen.slideDown();
          toOpen.parent().not(".open").addClass("open");
        }
        e.stopPropagation();
      });
  });
</script>

{%- if request.page_type == 'index' -%}
  {% assign potential_action_target = request.origin | append: routes.search_url | append: '?q={search_term_string}' %}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": {{ shop.name | json }},
      "potentialAction": {
        "@type": "SearchAction",
        "target": {{ potential_action_target | json }},
        "query-input": "required name=search_term_string"
      },
      "url": {{ request.origin | append: page.url | json }}
    }
  </script>
{%- endif -%}

{% schema %}
{
  "name": "Header",
  "class": "section-header header__outer header-section",
  "settings": [
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": true
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Logo Image"
    },
    {
      "type": "image_picker",
      "id": "image_m",
      "label": "Logo Image(Mobile)"
    },
    {
      "type": "textarea",
      "id": "greet_text",
      "label": "Greeting Message"
    },
    {
      "type": "textarea",
      "id": "invert_logo",
      "label": "Template Names Where Invert Logo will be applied(Mobile)",
      "info": "Enter page handles separated by commas (e.g., index,product,collection,cart)"
    },
    {
      "type": "checkbox",
      "id": "enable_transparent",
      "label": "Enable Transparent Header",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "sticky_logo",
      "label": "Transparent Header Logo"
    },
    {
      "type": "image_picker",
      "id": "sticky_logo_m",
      "label": "Transparent Header Logo(Mobile)"
    },
    {
      "type": "textarea",
      "id": "template_names",
      "label": "Template Names Where Sticky Nav Will be Applied",
      "info": "Enter page handles separated by commas (e.g., index,product,collection,cart)"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky",
      "label": "Enable Sticky Header",
      "default": true
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 100,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Logo Width",
      "default": 150
    },
    {
      "type": "range",
      "id": "logo_width_m",
      "min": 100,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Logo Width(Mobile)",
      "default": 150
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu"
    },
    {
      "type": "header",
      "content": "Section Spacing Desktop"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Top",
      "default": 24
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 0
    },
    {
      "type": "header",
      "content": "Section Spacing Mobile"
    },
    {
      "type": "range",
      "id": "margin_top_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Top",
      "default": 24
    },
    {
      "type": "range",
      "id": "margin_bottom_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_top_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "mega-menu",
      "name": "Mega Menu",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "For item"
        },
        {
          "type": "header",
          "content": "Collection list"
        },
        {
          "type": "header",
          "content": "Collection 1"
        },
        {
          "type": "collection",
          "id": "collection_1",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_1",
          "label": "Featured image"
        },
        {
          "type": "header",
          "content": "Collection 2"
        },
        {
          "type": "collection",
          "id": "collection_2",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_2",
          "label": "Featured image"
        },
        {
          "type": "header",
          "content": "Collection 3"
        },
        {
          "type": "collection",
          "id": "collection_3",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_3",
          "label": "Featured image"
        },
        {
          "type": "header",
          "content": "Collection 4"
        },
        {
          "type": "collection",
          "id": "collection_4",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_4",
          "label": "Featured image"
        },
        {
          "type": "header",
          "content": "Collection 5"
        },
        {
          "type": "collection",
          "id": "collection_5",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_5",
          "label": "Featured image"
        }
      ]
    }
   ],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %}
